package com.cybersoftteam.app.project_so.controller;

import java.util.ArrayList;

import com.cybersoftteam.app.project_so.R;
import com.cybersoftteam.app.project_so.controller.CustomerViewOrder.OnViewOrderItemSelectListener;
import com.cybersoftteam.app.project_so.model.OrderItem;

import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.KeyEvent;
import android.view.View;
import android.view.View.OnClickListener;

public class CustomerScreen extends CustomerBasedAcitivy implements OnClickListener,OnViewOrderItemSelectListener{
	private View lastView;
	private CustomerMenuItem customerMenuItem;

	@Override
	public void onCreate(Bundle savedInstanceState) {
		Log.i("activity", "=====this is customer screen======");
		//setContentView(R.layout.customer_screen);
		setLayoutIds(R.layout.customer_menu, R.layout.customer_screen);
		setAnimationDuration(300);
		setAnimationType(MENU_TYPE_SLIDEOVER);
		super.onCreate(savedInstanceState);

		// Set on clicking listener object
		lastView = findViewById(R.id.customer_menu_item);
		lastView.setOnClickListener(this);
		findViewById(R.id.configuration).setOnClickListener(this);
		findViewById(R.id.viewOrder).setOnClickListener(this);
		findViewById(R.id.logout).setOnClickListener(this);
		findViewById(R.id.logout).setOnClickListener(this);
		findViewById(R.id.exit).setOnClickListener(this);
		Log.i("van thi", "===========before init customer menu item===========");
		customerMenuItem =new CustomerMenuItem();
		Log.i("van thi", "===========after init customer menu item===========");

		// Create content fragment
		if (savedInstanceState == null) {

			// Add the fragment to the 'fragment_container' FrameLayout
			getSupportFragmentManager().beginTransaction().add(R.id.fragment_container,customerMenuItem ).commit();
		} else {
			viewContent(R.id.fragment_container, customerMenuItem);
		}	
	}

	@Override
	public void onClick(View v) {
		int id=v.getId();
		if(id==R.id.customer_menu_item){
			showMenuItem();
		}else if(id==R.id.configuration){
			showConfiguration();
		}else if(id==R.id.viewOrder){
			showViewOrder();
		}else if(id=R.id.logout){
			//close connect, clear data and ......
			Intent logoutIntent=new Intent(getApplicationContext(),LoginActivity.class);
			startActivity(logoutIntent);
		}
		// Set menu item background
		if (this.lastView != null) {
			this.lastView.setBackgroundResource(R.drawable.menu_bg);
		}

		lastView = v;
		v.setBackgroundResource(R.drawable.menu_bg_selected);
	}

	public void showMenuItem(){
		toggleMenu();
		//show menu item
		CustomerMenuItem fragment=new CustomerMenuItem();
		viewContent(R.id.fragment_container, fragment);
	}

	@Override
	public void showMenu(View view) {
		toggleMenu();
	}

	public void showConfiguration(){
		toggleMenu();
		
		CustomerConfiguration fragment=new CustomerConfiguration();
		viewContent(R.id.fragment_container, fragment);
	}

	public void showViewOrder(){
		toggleMenu();
		
		CustomerViewOrder fragment=new CustomerViewOrder();
		viewContent(R.id.fragment_container, fragment);
	}
	

	@Override
	public void onBackPressed() {
		super.onBackPressed();
	}
	@Override
	public boolean onKeyDown(int keyCode, KeyEvent event) {
		return super.onKeyDown(keyCode, event);
	}
	@Override
	protected void onDestroy() {
		super.onDestroy();
	}
	
	@Override
	public void onViewOrderItemSelected(ArrayList<OrderItem> ois) {
		//the customer selected the view order item of customer view order
		//capture the list view order item from the customer screen
		ListViewOrderItem listViewOrderItem=new ListViewOrderItem();
		viewContent(R.id.fragment_container, listViewOrderItem);
		//Log.i("vanthi", "*******************ok step1");
		listViewOrderItem.updateListViewOrder(ois);
		//Log.i("vanthi", "*******************ok step2");
		
	}
}
